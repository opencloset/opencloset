// Generated by CoffeeScript 1.8.0

/*
<a href="#" id="waybill" data-type="waybill" data-name="key">awesome</a>
<script>
  $('#waybill').editable
    source: ['Fedex', 'DHL']
    value:
      parcel: 'Fedex'
      number: '123456'
</script>
 */
var Waybill;

Waybill = function(opts) {
  this.sourceData = opts.source;
  return this.init('waybill', opts, Waybill.defaults);
};

$.fn.editableutils.inherit(Waybill, $.fn.editabletypes.abstractinput);

$.extend(Waybill.prototype, {
  render: function() {
    var fillItems;
    this.$input = this.$tpl.find('input');
    this.$list = this.$tpl.find('select');
    this.$list.empty();
    fillItems = function($el, data) {
      var item, _i, _len;
      $el.append($('<option>', {
        value: '직접반납'
      }).text('직접반납'));
      for (_i = 0, _len = data.length; _i < _len; _i++) {
        item = data[_i];
        $el.append($('<option>', {
          value: item
        }).text(item));
      }
      return $el;
    };
    return fillItems(this.$list, this.sourceData);
  },
  value2html: function(value, element) {
    if (!value) {
      return $(element).empty();
    }
    return $(element).html([value.parcel, value.number].join(','));
  },
  html2value: function(html) {
    var number, parcel, _ref;
    _ref = html.split(','), parcel = _ref[0], number = _ref[1];
    return {
      parcel: parcel,
      number: number
    };
  },
  value2str: function(value) {
    return [value.parcel, value.number].join(',');
  },
  str2value: function(str) {
    return str;
  },
  value2input: function(value) {
    if (!value) {
      return;
    }
    this.$list.val(value.parcel);
    return this.$input.filter('[name="number"]').val(value.number);
  },
  input2value: function() {
    return {
      parcel: this.$list.val(),
      number: this.$input.filter('[name="number"]').val()
    };
  },
  activate: function() {
    return this.$list.focus();
  },
  autosubmit: function() {
    return this.$input.keydown(function(e) {
      if (e.which === 13) {
        return $(this).closest('form').submit();
      }
    });
  }
});

Waybill.defaults = $.extend({}, $.fn.editabletypes.abstractinput.defaults, {
  tpl: '<div class="editable-waybill">\n  <label><select name="parcel"></select></label>\n  <label><input type="text" name="number" placeholder="운송장번호"></label>\n</div>',
  inputclass: '',
  source: []
});

$.fn.editabletypes.waybill = Waybill;
